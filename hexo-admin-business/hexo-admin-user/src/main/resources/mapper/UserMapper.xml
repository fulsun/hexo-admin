<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="pers.fulsun.hexoadmin.user.infrastructure.mapper.UsersMapper">
    <sql id="tableName">
        users
    </sql>

    <sql id="baseColumn">
        id,nick_name,telephone,password_hash,state,last_login_time,user_role,gmt_create,gmt_modified,deleted,lock_version
    </sql>

    <resultMap id="BaseResultMap" type="pers.fulsun.hexoadmin.user.domain.entity.Users">
        <result property="id" column="ID"/>
        <result property="gmtCreate" column="GMT_CREATE"/>
        <result property="gmtModified" column="GMT_MODIFIED"/>
        <result property="nickName" column="NICK_NAME"/>
        <result property="passwordHash" column="PASSWORD_HASH"/>
        <result property="state" column="STATE"/>
        <result property="telephone" column="TELEPHONE"/>
        <result property="lastLoginTime" column="LAST_LOGIN_TIME"/>
        <result property="userRole" column="USER_ROLE"/>
        <result property="deleted" column="DELETED"/>
        <result property="lockVersion" column="LOCK_VERSION"/>
    </resultMap>
    
    
    <select id="findById" resultMap="BaseResultMap">
        select
        <include refid="baseColumn"/>
        from users where deleted=0
        <if test="id !=null">AND id = #{id}</if>
    </select>
    
    <!--auto generated by MybatisCodeHelper on 2025-03-27-->
    <select id="findByTelephone" resultMap="BaseResultMap">
        select
        <include refid="baseColumn"/>
        from users
        where deleted=0
        <if test=" telephone != null and telephone != ''">
            and TELEPHONE=#{telephone}
        </if>
    </select>
    <select id="findByTelephoneAndPass" resultMap="BaseResultMap">
        select
        <include refid="baseColumn"/>
        from users where deleted=0
        <if test="telephone!=null">AND telephone = #{telephone}</if>
        <if test="passwordHash!=null">AND password_hash = #{passwordHash}</if>
    </select>
    
    <select id="findByNickname" resultMap="BaseResultMap">
        select
        <include refid="baseColumn"/>
        from users where deleted=0
        <if test="nickName!=null">AND nick_name = #{nickName}</if>
    </select>
    
    
    <select id="findByInviteCode" resultMap="BaseResultMap">
        select
        <include refid="baseColumn"/>
        from users where deleted=0
        <if test="inviteCode!=null">AND invite_code = #{inviteCode}</if>
    </select>
</mapper>
